/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package click;

/**
 *
 * @author Arun Kumar V
 */
import java.awt.Desktop;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;
import java.io.BufferedWriter;
import java.io.File;
import java.io.FileWriter;
import java.io.IOException;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.JButton;
import javax.swing.JTextField;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JOptionPane;

public class clickjack extends JPanel {

    public clickjack() {

        final JTextField txt = new JTextField("Please enter the web 

page address here");
        txt.setBounds(30, 30, 400, 30);
        txt.addMouseListener(new MouseAdapter() {

            @Override
            public void mouseClicked(MouseEvent e) {
                txt.setText("");
            }
        });

        JButton button = new JButton("Click Me");
        //button.setBounds(340, 80, 90, 40);
        button.setBounds(340, 80, 98, 27);
        JButton button1 = new JButton("About");
        button1.setBounds(350, 2, 80, 20);
        setLayout(null);
        add(txt);
        add(button);
        add(button1);


        button1.addActionListener(new ActionListener() {

            public void actionPerformed(ActionEvent e) {
                String getTxt ="ClickMe will help you to create a test 

page for Click jacking vulnerability.\n"+
                        "If a website is vulnerable to Clickjacking ,then 

target web page can be loaded into an frame.\n"+
                        "To do this we need to create a simple web page 

that includes a frame containing the target web page.\n" +
                        "This can be done using Click Me in an easy way..

\n\n"
                        + "How To test: \n\n"
                        + "1.Give the URL of your target site in the space 

given.\n"
                        + "2.Hit the Click Me button.\n"
                        + "3.That's it! Now please check whether your site 

is getting loaded in a frame.\n\n"
                        + "Remediation:\n\n"
                        + "1.Set X Frame Option to DENY or SAME 

ORIGIN.\n"
                        + "2.Use frame breaking scripts.\n\n"
                        + "Reference:   OWASP\n\n"
                        + "God Bless :)"
                        + "\nThanks\nArun Kumar V";
                JOptionPane.showMessageDialog(null, getTxt, "About: 

", JOptionPane.INFORMATION_MESSAGE);
            }
        });

        button.addActionListener(new ActionListener() {

        public void actionPerformed(ActionEvent e) {
                {
                    BufferedWriter bw = null;
                    try {
                        String url = txt.getText();
                        if(url.equals("")== true || url.equals("Please enter the 

web page address here")==true) {
                            System.out.println("hi");
                String message = "Please enter the test URL and then 

Click Me :)";
    JOptionPane.showMessageDialog(new JFrame(), message, 

"Wake up!",
        JOptionPane.ERROR_MESSAGE);
                        }else {

                        File f = new File("clickjacktest.html");
                        bw = new BufferedWriter(new FileWriter(f));
                        bw.write("<html>\n");
                        bw.write("<body>\n");
                        bw.write("<h1>Clickjack Test Page</h1>\n");
                        bw.write("<iframe src=\"" + url + "\"width=\"800\" 

height=\"500\"></iframe>\n");
                        bw.write("<!-- Click Me Clickjack Test Page 

@Arun Kumar -->\n");
                        bw.write("</body>\n");
                        bw.write("</html>\n");
                        bw.close();
                        Desktop.getDesktop().browse(f.toURI());
                        }
                    } catch (IOException ex) {
                        Logger.getLogger(clickjack.class.getName()).log

(Level.SEVERE, null, ex);
                    } finally {
                        try {
                            bw.close();
                        } catch (IOException ex) {
                            Logger.getLogger(clickjack.class.getName

()).log(Level.SEVERE, null, ex);
                        }
                    }
                }
            }
        });
    }

    public static void main(String[] args) {
        JFrame frame = new JFrame("ClickMe");
        frame.setLocationRelativeTo(null);
        frame.getContentPane().add(new clickjack());
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setSize(500, 180);
        frame.setVisible(true);
        frame.setResizable(false);
    }
}
